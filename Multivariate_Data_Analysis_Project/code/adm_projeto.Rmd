---
title: "projectoadm"
author: "ri"
date: "2025-11-15"
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Methodologies**

Use of RStudio to perform the preliminary analysis, PCA and Cluster
analysis. The report was created using Rmarkdown.

**Importance of the study**

This study is being carried out, in 41 USA cities, in order to
understand the key factors of pollution causing, with the corresponding
variables available, in this case : the sulfur dioxide content of air
(mg/m3), the average annual temperature (F), the number of manufacturing
enterprises employing 20 or more workers, the average wind speed
(miles/hour), annual precipitation (inches) and number of days with
precipitation/year (average).

The study is relevant because it allowed us to analyse the correlation
between its variables and conclude which factors contributed the most,
in this case, to pollution, in cities in the USA, in 1970.

## 1. Preliminary analysis of the data

Performing a preliminary analysis of the data before doing the PCA and
the Cluster analysis.

```{r}
#run the data
data5 <- read.csv("C:/Users/riisz/Desktop/avr/data_5(1).csv", header = TRUE)
head(data5)
```

```{r}
dim(data5)
str(data5)
```

**Problem and motivation of the data**

The data consists of 41 cities in the USA, with 7 other corresponding
variables, numeric, for each one of the cities, in order to perform a
study on pollution :

**so2** - Sulfur dioxide content of air in micrograms per cubic meter

**temp** -Average annual temperature (F)

**manuf** - No. of manufacturing enterprises employing 20 or more
workers

**pop** - Population size (1970 census) in thousands

**wind** - Average wind speed in miles per hour

**precip** - Average annual precipitation in inches

**days** - Average number of days with precipitation per year (annual
average number of days of rain)

```{r}
#new data only with numeric variables
data5_variables <- data5[,2:8]
head(data5_variables)
```

```{r}
#localization measures
summary(data5_variables)
```

The mean and median values are close to each other. Only the variables
"manuf" and "pop", when compared to the other variables, have different
values, which makes sense because its related to the number of people
employed by manufacturing enterprises and the population number.

```{r}
#dispersion measures
library(dplyr)
data5_variables %>% summarise_if(is.numeric, sd) #standard deviation of every numeric variable in this data frame.
```

We can see that the variables with higher standard deviation are "pop"
and "manuf". So, these variables have values changing a lot around the
mean, which means, that depending on the city, these values are very
different.

```{r}
pairs(data5_variables)
```

```{r}
cor(data5_variables)
```

By looking at the plot and the correlation values between the variables
we can observe that the population size and the number of manufacturing
enterprises employing 20 or more workers is strongly correlated (0.955). We can see that the most populated cities in this study (looking at the initial data, data5), employ more people. 
Then, we can observe that the number of manufacturing enterprises employing workers and the sulfur dioxide content of air (mg/m3) are correlated as well (0.645), which means that the manufacturing enterprises that employ 20 or more workers end up influencing so2 levels, which makes sense. 
Population and so2 levels are correlated as well (0.494), and precipitation and number of days too (0.496).
Even though with a lower value, precipitation  and temperature variables are correlated (0.386).

```{r}
#pop and manuf variables
plot(data5_variables$pop,data5_variables$manuf, col="blue", pch=19, xlab="population size", ylab="no. manufacturing enterprises employing")
m1 <- lm(pop ~ manuf , data=data5_variables)
summary(m1)
abline(m1, col="darkorange", lwd=2)
```

